import{l as r,p as v,A as o,q as S,_ as L,B as k,b as P,d as y,o as c,c as d,t as g,x as h,F as w,h as B,f as u,D as q}from"./index.ea2c1fb6.js";import{d as M,m as I}from"./MealPlansService.70e26976.js";function D(){return(new Date().getTime()/1e3|0).toString(16)+"xxxxxxxxxxxxxxxx".replace(/[x]/g,()=>(Math.random()*16|0).toString(16)).toLowerCase()}class b{async getShoppingListByDayId(i){const t=[];r.log(i,"this is id");const e=await v.getPlannedMealsByDayId(i);r.log(e.data.plannedMeals,"this is day meals");for(let l=0;l<e.data.plannedMeals.length;l++){const s=e.data.plannedMeals[l];for(let a=0;a<s.recipe.ingredients.length;a++){let p=s.recipe.ingredients[a];p.recipeId=s.recipe.id,p.id=D(),t.push(p)}r.log(t)}t.sort(function(l,s){return l.food.localeCompare(s.food)}),await this.saveShoppingList(i,t),o.shoppingList=t,r.log("app state shopping list",o.shoppingList)}async getShoppingListByMealPlanId(i){const t=[],e=[];await M.getDays(i),r.log(o.activeDays,"Got days by Meal Plan ID");let l=o.activeDays;for(let s=0;s<l.length;s++){let a=await v.getPlannedMealsByDayId(l[s].id);t.push(...a.data.plannedMeals);for(let p=0;p<t.length;p++){const m=t[p];for(let f=0;f<m.recipe.ingredients.length;f++){let x=m.recipe.ingredients[f];x.recipeId=m.recipe.id,x.id=D(),e.push(x)}}}r.log(e),e.sort(function(s,a){return s.food.localeCompare(a.food)}),o.shoppingList=e,r.log("app state shopping list",o.shoppingList)}async saveShoppingList(i,t){const e=await S.post("api/shoppinglist",{dayId:i,ingredients:t});r.log(e.data,"response from server")}}const _=new b,C={setup(){const n=k();P(()=>{i()});async function i(){n.query.day&&(await _.getShoppingListByDayId(n.query.day),await M.getDayInfoByDayId(n.query.day)),n.query.mealplan&&(await _.getShoppingListByMealPlanId(n.query.mealplan),await I.getMealPlanById(n.query.mealplan))}return{days:y(()=>o.activeDays),ingredients:y(()=>o.shoppingList),activeDay:y(()=>o.activeDay),activeMealPlan:y(()=>o.activeMealPlan),route:n}}},A={key:0,class:"p-1 mb-3"},N={key:1,class:"p-1 mb-3"},V={class:"d-flex"},j=u("div",{class:"form-check ms-2"},[u("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault"}),u("label",{class:"form-check-label",for:"flexCheckDefault"})],-1),F={key:0},T={key:1};function E(n,i,t,e,l,s){return c(),d("div",null,[e.activeDay&&e.route.query.day?(c(),d("h2",A,g(e.activeDay.name)+" of "+g(e.activeDay.mealPlan.name)+" shopping list ",1)):h("",!0),e.activeMealPlan&&e.route.query.mealplan?(c(),d("h2",N,g(e.activeMealPlan.name)+" shopping list ",1)):h("",!0),(c(!0),d(w,null,B(e.ingredients,a=>(c(),d("div",V,[j,u("p",null,[q(g(a.food)+" ",1),a.quantity!=0?(c(),d("span",F,g(a.quantity),1)):h("",!0),a.measure!="<unit>"?(c(),d("span",T,g(a.measure),1)):h("",!0)])]))),256))])}const z=L(C,[["render",E]]);export{z as default};
